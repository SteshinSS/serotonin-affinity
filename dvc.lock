schema: '2.0'
stages:
  filter:
    cmd: python scripts/preprocessing/filter.py --threshold=8.0 --keep_null=true data/raw/smiles.tsv.gz
      data/raw/activities.tsv.gz data/filtered/filtered.csv
    deps:
    - path: data/raw/activities.tsv.gz
      md5: 91eb205b6a7b5edcfe0bd76aa685fb6e
      size: 67518
    - path: data/raw/smiles.tsv.gz
      md5: 683875548e9d7b5b98b7349ee325e41d
      size: 24872450
    - path: scripts/preprocessing/filter.py
      md5: ea7f75ac5c3b9accab8973a5f59c3586
      size: 3060
    outs:
    - path: data/filtered
      md5: 9f06ebed05017f359cbaabc0db18c8b1.dir
      size: 361545
      nfiles: 1
  split:
    cmd: python scripts/preprocessing/split.py --test_ratio=0.2 --val_ratio=0.1 --homology_based
      true --random_seed 228 data/filtered/filtered.csv data/splitted
    deps:
    - path: data/filtered
      md5: 9f06ebed05017f359cbaabc0db18c8b1.dir
      size: 361545
      nfiles: 1
    - path: scripts/preprocessing/split.py
      md5: 3f764a85015cbc979c861ef236b9798b
      size: 3762
    outs:
    - path: data/splitted
      md5: 815ea81c828fd6bb94518bbeab6261a5.dir
      size: 361597
      nfiles: 3
  featurize_topological_fp:
    cmd: python scripts/preprocessing/featurize_topological_fp.py data/splitted data/features/fingerprints/topological
    deps:
    - path: data/splitted
      md5: 815ea81c828fd6bb94518bbeab6261a5.dir
      size: 361597
      nfiles: 3
    - path: scripts/preprocessing/featurize_topological_fp.py
      md5: 17fca59680a892439f6039be4c589e25
      size: 1850
    outs:
    - path: data/features/fingerprints/topological
      md5: 6b0cd818e2d83a320516e91688ad343f.dir
      size: 3695146
      nfiles: 3
  featurize_maccs_fp:
    cmd: python scripts/preprocessing/featurize_maccs_fp.py data/splitted data/features/fingerprints/maccs
    deps:
    - path: data/splitted
      md5: 815ea81c828fd6bb94518bbeab6261a5.dir
      size: 361597
      nfiles: 3
    - path: scripts/preprocessing/featurize_maccs_fp.py
      md5: 9e00796d064c56e312a6b25bff16d869
      size: 1874
    outs:
    - path: data/features/fingerprints/maccs
      md5: 734bc3ad073d48ac0cd949118017c1b0.dir
      size: 204812
      nfiles: 3
  featurize_morgan_fp:
    cmd: python scripts/preprocessing/featurize_morgan_fp.py --radius=2 --n_bits=1024
      data/splitted data/features/fingerprints/morgan
    deps:
    - path: data/splitted
      md5: 815ea81c828fd6bb94518bbeab6261a5.dir
      size: 361597
      nfiles: 3
    - path: scripts/preprocessing/featurize_morgan_fp.py
      md5: a16c0bbbd0a95ad45437c90487e3b5ad
      size: 2221
    outs:
    - path: data/features/fingerprints/morgan
      md5: 0cba6cbc23dc43840572b3607c5e6540.dir
      size: 622641
      nfiles: 3
  train_gb_topological_fp:
    cmd: python scripts/training/train_gb.py --subsample=0.1 data/features/fingerprints/topological/train.npz
      models/gb_topological_fp/model.pkl
    deps:
    - path: data/features/fingerprints/topological/train.npz
      md5: bef74e239ed09425f1d6684d9d4adbf3
      size: 2673804
    - path: scripts/training/train_gb.py
      md5: d70a1074158672ce68ca378c7c3d7460
      size: 1660
    outs:
    - path: models/gb_topological_fp/model.pkl
      md5: 5e332adbf5c2dda29b879d407988f1ca
      size: 124891
  train_gb_maccs_fp:
    cmd: python scripts/training/train_gb.py --subsample=0.1 --use_weights=true data/features/fingerprints/maccs/train.npz
      models/gb_maccs_fp/model.pkl
    deps:
    - path: data/features/fingerprints/maccs/train.npz
      md5: 93a7ed8dc38ba5f66646ac770698604b
      size: 147786
    - path: scripts/training/train_gb.py
      md5: d70a1074158672ce68ca378c7c3d7460
      size: 1660
    outs:
    - path: models/gb_maccs_fp/model.pkl
      md5: 32899cce9490193f74b835c72ea09d41
      size: 123822
  train_gb_morgan_fp:
    cmd: python scripts/training/train_gb.py --subsample=0.1 data/features/fingerprints/morgan/train.npz
      models/gb_morgan_fp/model.pkl
    deps:
    - path: data/features/fingerprints/morgan/train.npz
      md5: 9525895163c32f5fa67d7ced6268f0ea
      size: 449450
    - path: scripts/training/train_gb.py
      md5: d70a1074158672ce68ca378c7c3d7460
      size: 1660
    outs:
    - path: models/gb_morgan_fp/model.pkl
      md5: 356de56fb6e6e275f0e74b500bfcc938
      size: 122972
  generate_conformers:
    cmd: python pipeline/generate_conformers.py data/splitted data/conformers
    deps:
    - path: data/splitted
      md5: d70a2f15bfb6f458327e94e4deb32d7b.dir
      size: 361597
      nfiles: 3
    - path: pipeline/generate_conformers.py
      md5: b31bcaa9465e897410f3b7bfbc521740
      size: 2033
    outs:
    - path: data/conformers
      md5: bcee52d74eb9d7304e7f2070d0ef3d65.dir
      size: 8483776
      nfiles: 3
  generate_voxels:
    cmd: python pipeline/generate_voxels.py --voxel_size=0.5 --box_size_x=10 --box_size_y=10
      --box_size_z=10 data/conformers data/voxels
    deps:
    - path: data/conformers
      md5: bcee52d74eb9d7304e7f2070d0ef3d65.dir
      size: 8483776
      nfiles: 3
    - path: pipeline/generate_voxels.py
      md5: eb9c84066a90234078ac9d517ae04c16
      size: 2394
    outs:
    - path: data/voxels
      md5: 50a6fdd1cfaef4d8a473cc7b68629195.dir
      size: 1022491856
      nfiles: 3
  evaluate_gb_topological_fp@val:
    cmd: python scripts/evaluation/eval_gb.py models/gb_topological_fp/model.pkl data/features/fingerprints/topological/val.npz
      results/gb_topological_fp/val.json
    deps:
    - path: data/features/fingerprints/topological/val.npz
      md5: 38fe0caa67c856de78155b8b5eb2b11e
      size: 288890
    - path: models/gb_topological_fp/model.pkl
      md5: 5e332adbf5c2dda29b879d407988f1ca
      size: 124891
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_topological_fp/val.json
      md5: 48952d1bb6a403830b71bec17f90fc0a
      size: 83
  evaluate_gb_topological_fp@train:
    cmd: python scripts/evaluation/eval_gb.py models/gb_topological_fp/model.pkl data/features/fingerprints/topological/train.npz
      results/gb_topological_fp/train.json
    deps:
    - path: data/features/fingerprints/topological/train.npz
      md5: bef74e239ed09425f1d6684d9d4adbf3
      size: 2673804
    - path: models/gb_topological_fp/model.pkl
      md5: 5e332adbf5c2dda29b879d407988f1ca
      size: 124891
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_topological_fp/train.json
      md5: 4273a3312488800bd602655b8dea231e
      size: 95
  evaluate_gb_maccs_fp@val:
    cmd: python scripts/evaluation/eval_gb.py models/gb_maccs_fp/model.pkl data/features/fingerprints/maccs/val.npz
      results/gb_maccs_fp/val.json
    deps:
    - path: data/features/fingerprints/maccs/val.npz
      md5: e3d4faa8653e29482cf182007686b1dd
      size: 16367
    - path: models/gb_maccs_fp/model.pkl
      md5: 32899cce9490193f74b835c72ea09d41
      size: 123822
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_maccs_fp/val.json
      md5: 94b87aa4d8fb80cf7f4f1520078b186f
      size: 96
  evaluate_gb_morgan_fp@train:
    cmd: python scripts/evaluation/eval_gb.py models/gb_morgan_fp/model.pkl data/features/fingerprints/morgan/train.npz
      results/gb_morgan_fp/train.json
    deps:
    - path: data/features/fingerprints/morgan/train.npz
      md5: 9525895163c32f5fa67d7ced6268f0ea
      size: 449450
    - path: models/gb_morgan_fp/model.pkl
      md5: 356de56fb6e6e275f0e74b500bfcc938
      size: 122972
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_morgan_fp/train.json
      md5: d8b3fc7c70d56041ddb03fdec0afbb9d
      size: 93
  evaluate_gb_morgan_fp@val:
    cmd: python scripts/evaluation/eval_gb.py models/gb_morgan_fp/model.pkl data/features/fingerprints/morgan/val.npz
      results/gb_morgan_fp/val.json
    deps:
    - path: data/features/fingerprints/morgan/val.npz
      md5: 6c59502f6aa93e3b59496f8bf76c3dc9
      size: 48935
    - path: models/gb_morgan_fp/model.pkl
      md5: 356de56fb6e6e275f0e74b500bfcc938
      size: 122972
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_morgan_fp/val.json
      md5: 5175ee1df319a7d495257317b050d6a2
      size: 96
  evaluate_gb_maccs_fp@train:
    cmd: python scripts/evaluation/eval_gb.py models/gb_maccs_fp/model.pkl data/features/fingerprints/maccs/train.npz
      results/gb_maccs_fp/train.json
    deps:
    - path: data/features/fingerprints/maccs/train.npz
      md5: 93a7ed8dc38ba5f66646ac770698604b
      size: 147786
    - path: models/gb_maccs_fp/model.pkl
      md5: 32899cce9490193f74b835c72ea09d41
      size: 123822
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_maccs_fp/train.json
      md5: 78f19b90bdadedbcfc964c75f755c4ab
      size: 95
