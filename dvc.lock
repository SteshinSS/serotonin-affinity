schema: '2.0'
stages:
  filter:
    cmd: python scripts/preprocessing/filter.py --threshold=8.0 --keep_null=true data/raw/smiles.tsv.gz
      data/raw/activities.tsv.gz data/filtered/filtered.csv
    deps:
    - path: data/raw/activities.tsv.gz
      md5: 91eb205b6a7b5edcfe0bd76aa685fb6e
      size: 67518
    - path: data/raw/smiles.tsv.gz
      md5: 683875548e9d7b5b98b7349ee325e41d
      size: 24872450
    - path: scripts/preprocessing/filter.py
      md5: bb38d9602b93b23b8b5ff0ea6c883a93
      size: 3521
    outs:
    - path: data/filtered
      md5: 9f06ebed05017f359cbaabc0db18c8b1.dir
      size: 361545
      nfiles: 1
  split:
    cmd: python scripts/preprocessing/split.py --test_ratio=0.2 --val_ratio=0.1 --homology_based
      true --random_seed 228 data/filtered/filtered.csv data/splitted
    deps:
    - path: data/filtered
      md5: 9f06ebed05017f359cbaabc0db18c8b1.dir
      size: 361545
      nfiles: 1
    - path: scripts/preprocessing/split.py
      md5: 42a67ab34b5cf90db6f4a76f2e74c662
      size: 4381
    outs:
    - path: data/splitted
      md5: 6228c40c50cf71ab570195f7f8bfa595.dir
      size: 361597
      nfiles: 3
  featurize_topological_fp:
    cmd: python scripts/preprocessing/featurize_topological_fp.py data/splitted data/features/fingerprints/topological
    deps:
    - path: data/splitted
      md5: 6228c40c50cf71ab570195f7f8bfa595.dir
      size: 361597
      nfiles: 3
    - path: scripts/preprocessing/featurize_topological_fp.py
      md5: 17fca59680a892439f6039be4c589e25
      size: 1850
    outs:
    - path: data/features/fingerprints/topological
      md5: bf5b3d7aa6cf50c6af1a21092eac15a7.dir
      size: 3694179
      nfiles: 3
  featurize_maccs_fp:
    cmd: python scripts/preprocessing/featurize_maccs_fp.py data/splitted data/features/fingerprints/maccs
    deps:
    - path: data/splitted
      md5: 6228c40c50cf71ab570195f7f8bfa595.dir
      size: 361597
      nfiles: 3
    - path: scripts/preprocessing/featurize_maccs_fp.py
      md5: 9e00796d064c56e312a6b25bff16d869
      size: 1874
    outs:
    - path: data/features/fingerprints/maccs
      md5: 6e476a1955f7dc4b8f5fbf7958588374.dir
      size: 204873
      nfiles: 3
  featurize_morgan_fp:
    cmd: python scripts/preprocessing/featurize_morgan_fp.py --radius=2 --n_bits=1024
      data/splitted data/features/fingerprints/morgan
    deps:
    - path: data/splitted
      md5: 6228c40c50cf71ab570195f7f8bfa595.dir
      size: 361597
      nfiles: 3
    - path: scripts/preprocessing/featurize_morgan_fp.py
      md5: a16c0bbbd0a95ad45437c90487e3b5ad
      size: 2221
    outs:
    - path: data/features/fingerprints/morgan
      md5: dad94a5afa20d1ae1bdeef1d48a8cab6.dir
      size: 622669
      nfiles: 3
  train_gb_topological_fp:
    cmd: python scripts/training/train_gb.py --subsample=0.1 data/features/fingerprints/topological/train.npz
      models/gb_topological_fp/model.pkl
    deps:
    - path: data/features/fingerprints/topological/train.npz
      md5: 9e46f4dcf0d878d26c2acc4b657fc7af
      size: 2692151
    - path: scripts/training/train_gb.py
      md5: d70a1074158672ce68ca378c7c3d7460
      size: 1660
    outs:
    - path: models/gb_topological_fp/model.pkl
      md5: 4942f5364f1af1e4400e18cb58346ae0
      size: 124891
  train_gb_maccs_fp:
    cmd: python scripts/training/train_gb.py --subsample=0.3 --n_estimators=300 --max_depth=3
      --use_weights=true data/features/fingerprints/maccs/train.npz models/gb_maccs_fp/model.pkl
    deps:
    - path: data/features/fingerprints/maccs/train.npz
      md5: bae528ac6add579d9c0ec51c6f2ae8cc
      size: 148309
    - path: scripts/training/train_gb.py
      md5: fae5c50dc1c9ba434cd0b4da51c6eb27
      size: 2152
    outs:
    - path: models/gb_maccs_fp/model.pkl
      md5: 6460bf2c682ab03a5efd6decfd9faba1
      size: 364519
  train_gb_morgan_fp:
    cmd: python scripts/training/train_gb.py --subsample=0.1 data/features/fingerprints/morgan/train.npz
      models/gb_morgan_fp/model.pkl
    deps:
    - path: data/features/fingerprints/morgan/train.npz
      md5: aa4e7622ff581a55c3d51819e5feb0c8
      size: 453055
    - path: scripts/training/train_gb.py
      md5: d70a1074158672ce68ca378c7c3d7460
      size: 1660
    outs:
    - path: models/gb_morgan_fp/model.pkl
      md5: f10791ad1fbb9ed0cc31111b2ef2b397
      size: 123484
  generate_conformers:
    cmd: python pipeline/generate_conformers.py data/splitted data/conformers
    deps:
    - path: data/splitted
      md5: d70a2f15bfb6f458327e94e4deb32d7b.dir
      size: 361597
      nfiles: 3
    - path: pipeline/generate_conformers.py
      md5: b31bcaa9465e897410f3b7bfbc521740
      size: 2033
    outs:
    - path: data/conformers
      md5: bcee52d74eb9d7304e7f2070d0ef3d65.dir
      size: 8483776
      nfiles: 3
  generate_voxels:
    cmd: python pipeline/generate_voxels.py --voxel_size=0.5 --box_size_x=10 --box_size_y=10
      --box_size_z=10 data/conformers data/voxels
    deps:
    - path: data/conformers
      md5: bcee52d74eb9d7304e7f2070d0ef3d65.dir
      size: 8483776
      nfiles: 3
    - path: pipeline/generate_voxels.py
      md5: eb9c84066a90234078ac9d517ae04c16
      size: 2394
    outs:
    - path: data/voxels
      md5: 50a6fdd1cfaef4d8a473cc7b68629195.dir
      size: 1022491856
      nfiles: 3
  evaluate_gb_topological_fp@val:
    cmd: python scripts/evaluation/eval_gb.py models/gb_topological_fp/model.pkl data/features/fingerprints/topological/val.npz
      results/gb_topological_fp/val.json
    deps:
    - path: data/features/fingerprints/topological/val.npz
      md5: be2a4173a93d6f6f3264d5351307481f
      size: 304670
    - path: models/gb_topological_fp/model.pkl
      md5: 4942f5364f1af1e4400e18cb58346ae0
      size: 124891
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_topological_fp/val.json
      md5: f535294ea18ad4d5695d65103d1c43fc
      size: 94
  evaluate_gb_topological_fp@train:
    cmd: python scripts/evaluation/eval_gb.py models/gb_topological_fp/model.pkl data/features/fingerprints/topological/train.npz
      results/gb_topological_fp/train.json
    deps:
    - path: data/features/fingerprints/topological/train.npz
      md5: 9e46f4dcf0d878d26c2acc4b657fc7af
      size: 2692151
    - path: models/gb_topological_fp/model.pkl
      md5: 4942f5364f1af1e4400e18cb58346ae0
      size: 124891
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_topological_fp/train.json
      md5: f32da3164360514e0747f97ce71e8aab
      size: 94
  evaluate_gb_maccs_fp@val:
    cmd: python scripts/evaluation/eval_gb.py models/gb_maccs_fp/model.pkl data/features/fingerprints/maccs/val.npz
      results/gb_maccs_fp/val.json
    deps:
    - path: data/features/fingerprints/maccs/val.npz
      md5: c8bdaac1ec0aaeb071d29c650e9d45c1
      size: 16971
    - path: models/gb_maccs_fp/model.pkl
      md5: 6460bf2c682ab03a5efd6decfd9faba1
      size: 364519
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_maccs_fp/val.json
      md5: 7bc217261f1b7978c48525c2c2526e5f
      size: 94
  evaluate_gb_morgan_fp@train:
    cmd: python scripts/evaluation/eval_gb.py models/gb_morgan_fp/model.pkl data/features/fingerprints/morgan/train.npz
      results/gb_morgan_fp/train.json
    deps:
    - path: data/features/fingerprints/morgan/train.npz
      md5: aa4e7622ff581a55c3d51819e5feb0c8
      size: 453055
    - path: models/gb_morgan_fp/model.pkl
      md5: f10791ad1fbb9ed0cc31111b2ef2b397
      size: 123484
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_morgan_fp/train.json
      md5: c1457a23c5bfd8ce9c9ecad795eb3867
      size: 95
  evaluate_gb_morgan_fp@val:
    cmd: python scripts/evaluation/eval_gb.py models/gb_morgan_fp/model.pkl data/features/fingerprints/morgan/val.npz
      results/gb_morgan_fp/val.json
    deps:
    - path: data/features/fingerprints/morgan/val.npz
      md5: 6c0ccacf46cafbf658ef1bd0d3119e40
      size: 51901
    - path: models/gb_morgan_fp/model.pkl
      md5: f10791ad1fbb9ed0cc31111b2ef2b397
      size: 123484
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_morgan_fp/val.json
      md5: 28523bedcc160c97a6b61882fefe921a
      size: 94
  evaluate_gb_maccs_fp@train:
    cmd: python scripts/evaluation/eval_gb.py models/gb_maccs_fp/model.pkl data/features/fingerprints/maccs/train.npz
      results/gb_maccs_fp/train.json
    deps:
    - path: data/features/fingerprints/maccs/train.npz
      md5: bae528ac6add579d9c0ec51c6f2ae8cc
      size: 148309
    - path: models/gb_maccs_fp/model.pkl
      md5: d550e93ad06967a2c0c932dd4c3ad700
      size: 123438
    - path: scripts/evaluation/eval_gb.py
      md5: f15370260290c4ae586311668b2bfbd0
      size: 1561
    outs:
    - path: results/gb_maccs_fp/train.json
      md5: 3be25b4351a85c3d6b8241893c48bd7f
      size: 93
